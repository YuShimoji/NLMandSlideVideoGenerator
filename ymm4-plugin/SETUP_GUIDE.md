# YMM4プラグイン動作確認手順

## 概要

本ドキュメントでは、YMM4（ゆっくりMovieMaker4）プラグインの動作確認手順を記載します。

## 前提条件

- Windows 10/11
- .NET 9.0 SDK インストール済み
- YMM4 v4.33.0.0以降 インストール済み
- Visual Studio 2022 または VS Code

## 確認項目

### 1. プラグインがYMM4で正常にロードされる

#### 手順

1. **Directory.Build.props の設定**
   ```powershell
   cd ymm4-plugin
   cp Directory.Build.props.sample Directory.Build.props
   ```

2. **YMM4パスの設定**
   `Directory.Build.props` を編集：
   ```xml
   <Project>
     <PropertyGroup>
       <YMM4DirPath>C:\Users\YourUserName\AppData\Local\YukkuriMovieMaker4\</YMM4DirPath>
     </PropertyGroup>
   </Project>
   ```

3. **ビルド実行**
   ```powershell
   dotnet build
   ```

4. **YMM4起動と確認**
   - YMM4を起動
   - `設定` → `プラグイン` → `プラグイン一覧` を開く
   - 「NLM Slide Plugin」が表示されることを確認

#### 期待される結果

- ビルドが成功すること
- YMM4のプラグイン一覧に「NLM Slide Plugin」が表示されること
- エラーダイアログが表示されないこと

---

### 2. CSVタイムラインから音声ファイルをインポートできる

#### 手順

1. **テスト用CSVファイル作成**
   ```csv
   ずんだもん,こんにちは、ずんだもんです
   四国めたん,こんにちは、四国めたんです
   ずんだもん,今日はいい天気ですね
   ```

2. **音声ファイル準備**
   - 上記CSVと同じディレクトリに `audio` フォルダを作成
   - `001.wav`, `002.wav`, `003.wav` を配置
   - （音声ファイルがない場合は、プレビュー時に「音声: 0件」と表示される）

3. **インポート実行**
   - YMM4で `ファイル` → `インポート` → `CSVタイムラインをインポート...` を選択
   - CSVファイルを選択
   - 音声ディレクトリを確認
   - 「プレビュー」ボタンをクリック
   - 内容を確認後、「インポート」ボタンをクリック

#### 期待される結果

- プレビューにCSVの内容が正しく表示されること
- 音声ファイルが存在する場合、音声ファイル名が表示されること
- インポートが正常に完了すること

---

### 3. タイミング情報が正しく反映される

#### 手順

1. **CSV読み込みとタイムライン計算**
   - 上記「CSVタイムラインから音声ファイルをインポートできる」を実行
   - プレビュー画面で「長さ」列を確認

2. **タイムライン確認**
   - 各行の開始時刻と終了時刻が計算されていることを確認
   - デフォルト音声長（3秒）が適用されていること

#### 期待される結果

| 行 | 話者 | 開始時刻 | 終了時刻 |
|---|------|---------|---------|
| 1 | ずんだもん | 0.0s | 3.0s |
| 2 | 四国めたん | 3.0s | 6.0s |
| 3 | ずんだもん | 6.0s | 9.0s |

---

## スクリーンショット記録

各確認項目で以下のスクリーンショットを取得してください：

1. **プラグイン一覧画面**
   - YMM4設定→プラグイン一覧で「NLM Slide Plugin」が表示されている状態

2. **CSVインポートダイアログ**
   - ファイル選択後のプレビュー画面
   - 行番号、話者、テキスト、音声ファイル名が表示されている状態

3. **インポート完了ダイアログ**
   - インポート成功メッセージ

---

## トラブルシューティング

### プラグインが表示されない場合

1. **ビルド出力の確認**
   ```powershell
   dir "C:\Users\YourUserName\AppData\Local\YukkuriMovieMaker4\user\plugin\NLMSlidePlugin\"
   ```
   - `NLMSlidePlugin.dll` が存在することを確認

2. **YMM4の再起動**
   - YMM4を完全に終了し、再起動

3. **プラグインログの確認**
   - YMM4のログ出力を確認（設定→詳細設定→ログ）

### 音声ファイルが認識されない場合

1. **ファイル名の確認**
   - `001.wav`, `002.wav` 形式であること
   - 行番号と対応していること（1-based）

2. **ディレクトリの確認**
   - 音声ディレクトリが正しく設定されていること
   - フルパスに日本語が含まれていないこと（推奨）

### CSVが読み込めない場合

1. **エンコーディングの確認**
   - UTF-8 (BOMあり/なし) で保存されていること

2. **フォーマットの確認**
   - `話者,テキスト` 形式であること
   - ダブルクォートで囲まれたカンマを含むテキストにも対応

---

## テスト実行

ユニットテストを実行する場合：

```powershell
cd ymm4-plugin
dotnet test tests/
```

### 期待される結果

```
Test Run Successful.
Total tests: 7
     Passed: 7
```
