# システム仕様書

## 1. システム概要

### 1.1 目的
YouTube向け解説動画の制作プロセスを完全自動化し、ニュース記事やトピックから高品質な動画コンテンツを効率的に生成する。

### 1.2 システム名
NLMandSlideVideoGenerator（NotebookLM and Slide Video Generator）

### 1.3 対象ユーザー
- YouTubeコンテンツクリエイター
- 教育関係者
- 企業のマーケティング担当者
- ニュース解説チャンネル運営者

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 ソース収集・音声生成機能
- **入力**: ニュース記事URL、調査トピック
- **処理**: NotebookLMによる関連ソース収集（最大10件）
- **出力**: ラジオ風音声解説ファイル
- **品質保証**: 音声品質の自動検証機能

#### 2.1.2 台本生成・検証機能
- **入力**: 生成された音声ファイル
- **処理**: NotebookLMによる文字起こし
- **出力**: 構造化された台本データ
- **品質保証**: 台本内容の自動検証・修正機能

#### 2.1.3 スライド自動生成機能
- **入力**: 検証済み台本
- **処理**: Google Slideでの分割スライド生成
- **出力**: PowerPoint形式のスライドファイル
- **制約対応**: 文字数制限による要点抽出機能

#### 2.1.4 動画編集・合成機能
- **入力**: 音声ファイル、スライドファイル
- **処理**: 
  - 日本語字幕の自動付与
  - スライド画像のリッチエフェクト適用
  - 音声と映像の同期
- **出力**: 完成動画ファイル（MP4形式）

#### 2.1.5 YouTube自動アップロード機能
- **入力**: 完成動画、メタデータ
- **処理**: YouTube APIによる自動アップロード
- **出力**: 公開済み動画URL
- **付加機能**: 概要欄生成、投稿予約設定

### 2.2 補助機能

#### 2.2.1 コンテンツ管理機能
- プロジェクト履歴管理
- 生成ファイルのバージョン管理
- 作業進捗の可視化

#### 2.2.2 品質管理機能
- 音声品質の自動評価
- 台本内容の整合性チェック
- スライドレイアウトの最適化

#### 2.2.3 エラーハンドリング機能
- API制限対応
- ネットワークエラー対応
- ファイル破損対応

## 3. 非機能要件

### 3.1 性能要件
- **処理時間**: 10分の音声に対して30分以内での動画生成
- **同時処理**: 最大3プロジェクトの並行処理
- **ファイルサイズ**: 最大2GBの動画ファイル対応

### 3.2 可用性要件
- **稼働率**: 99%以上
- **復旧時間**: 障害発生から1時間以内

### 3.3 セキュリティ要件
- **API キー管理**: 環境変数による安全な管理
- **ファイル暗号化**: 機密情報を含むファイルの暗号化
- **アクセス制御**: ユーザー認証機能

### 3.4 保守性要件
- **モジュール化**: 各機能の独立性確保
- **ログ管理**: 詳細な処理ログの記録
- **テスト**: 90%以上のテストカバレッジ

## 4. システム構成

### 4.1 アーキテクチャ概要
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   入力層        │    │   処理層        │    │   出力層        │
│                 │    │                 │    │                 │
│ ・URL/トピック  │───▶│ ・NotebookLM    │───▶│ ・動画ファイル  │
│ ・設定パラメータ│    │ ・Google Slide  │    │ ・YouTube URL   │
│                 │    │ ・動画編集      │    │ ・ログファイル  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 4.2 データフロー
1. **入力フェーズ**: ユーザー入力の受付・検証
2. **収集フェーズ**: NotebookLMによるソース収集
3. **生成フェーズ**: 音声・台本・スライドの生成
4. **編集フェーズ**: 動画編集・エフェクト適用
5. **出力フェーズ**: YouTube アップロード・結果通知

### 4.3 外部システム連携
- **NotebookLM**: 音声生成・文字起こし
- **Google Slides**: スライド生成
- **YouTube API**: 動画アップロード
- **外部ニュースサイト**: ソース記事取得

## 5. 技術仕様

### 5.1 開発環境
- **言語**: Python 3.9+
- **フレームワーク**: FastAPI（API サーバー）
- **データベース**: SQLite（開発）/ PostgreSQL（本番）
- **キューシステム**: Celery + Redis

### 5.2 主要ライブラリ
```python
# 動画・音声処理
moviepy==1.0.3
pydub==0.25.1

# 画像処理
Pillow==10.0.0
opencv-python==4.8.0

# API クライアント
google-api-python-client==2.100.0
google-auth-oauthlib==1.0.0

# Web スクレイピング
requests==2.31.0
beautifulsoup4==4.12.2

# 非同期処理
celery==5.3.1
redis==4.6.0

# テスト・品質管理
pytest==7.4.0
black==23.7.0
flake8==6.0.0
mypy==1.5.0
```

### 5.3 API 仕様
#### 5.3.1 メイン処理API
```
POST /api/v1/generate-video
Content-Type: application/json

{
  "topic": "調査トピック",
  "urls": ["https://example.com/news1", "https://example.com/news2"],
  "settings": {
    "max_slides": 20,
    "video_quality": "1080p",
    "subtitle_language": "ja",
    "upload_schedule": "2024-01-01T12:00:00Z"
  }
}
```

#### 5.3.2 進捗確認API
```
GET /api/v1/status/{job_id}

Response:
{
  "job_id": "uuid",
  "status": "processing|completed|failed",
  "progress": 75,
  "current_stage": "video_editing",
  "estimated_completion": "2024-01-01T13:30:00Z"
}
```

## 6. 運用要件

### 6.1 監視要件
- **システム監視**: CPU、メモリ、ディスク使用量
- **API監視**: 外部API の応答時間・エラー率
- **品質監視**: 生成動画の品質指標

### 6.2 バックアップ要件
- **データバックアップ**: 日次自動バックアップ
- **設定バックアップ**: 週次設定ファイルバックアップ
- **復旧手順**: 災害復旧計画書の整備

### 6.3 ログ要件
- **アプリケーションログ**: INFO レベル以上
- **エラーログ**: ERROR レベル以上、詳細スタックトレース
- **監査ログ**: ユーザー操作、API呼び出し履歴

## 7. 制約事項・リスク

### 7.1 技術的制約
- NotebookLM の利用制限（1日あたりの処理回数）
- Google Slides API の制限
- YouTube API のクォータ制限

### 7.2 法的制約
- 著作権法の遵守
- 各プラットフォームの利用規約遵守
- 個人情報保護法の遵守

### 7.3 リスク要因
- **外部API依存**: サービス停止時の影響
- **品質リスク**: AI生成コンテンツの品質ばらつき
- **コスト リスク**: API 利用料金の変動

## 8. 今後の拡張計画

### 8.1 短期計画（3ヶ月以内）
- 基本機能の実装・テスト
- ユーザーインターフェースの構築
- 初期ユーザーでのβテスト

### 8.2 中期計画（6ヶ月以内）
- 多言語対応
- カスタムテンプレート機能
- 高度な動画エフェクト

### 8.3 長期計画（1年以内）
- AI による自動最適化機能
- 他プラットフォーム対応（TikTok、Instagram等）
- エンタープライズ向け機能
